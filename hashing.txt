#include <stdio.h>
#include <stdlib.h>

#define TABLE_SIZE 10

// ------------------- LINEAR PROBING -------------------
int linearHashInsert(int table[], int key) {
    int hash = key % TABLE_SIZE;
    int i = 0;
    while (table[(hash + i) % TABLE_SIZE] != -1) {
        i++;
        if (i == TABLE_SIZE) return -1; // Table full
    }
    table[(hash + i) % TABLE_SIZE] = key;
    return (hash + i) % TABLE_SIZE;
}

int linearHashSearch(int table[], int key) {
    int hash = key % TABLE_SIZE;
    int i = 0;
    while (table[(hash + i) % TABLE_SIZE] != key) {
        if (table[(hash + i) % TABLE_SIZE] == -1 || i == TABLE_SIZE) return -1;
        i++;
    }
    return (hash + i) % TABLE_SIZE;
}

// ------------------- QUADRATIC PROBING -------------------
int quadraticHashInsert(int table[], int key) {
    int hash = key % TABLE_SIZE;
    int i = 0;
    while (table[(hash + i * i) % TABLE_SIZE] != -1) {
        i++;
        if (i == TABLE_SIZE) return -1; // Table full
    }
    table[(hash + i * i) % TABLE_SIZE] = key;
    return (hash + i * i) % TABLE_SIZE;
}

int quadraticHashSearch(int table[], int key) {
    int hash = key % TABLE_SIZE;
    int i = 0;
    while (table[(hash + i * i) % TABLE_SIZE] != key) {
        if (table[(hash + i * i) % TABLE_SIZE] == -1 || i == TABLE_SIZE) return -1;
        i++;
    }
    return (hash + i * i) % TABLE_SIZE;
}

// ------------------- DOUBLE HASHING -------------------
int hash2(int key) {
    return 7 - (key % 7);
}

int doubleHashInsert(int table[], int key) {
    int hash1 = key % TABLE_SIZE;
    int hash_increment = hash2(key);
    int i = 0;
    while (table[(hash1 + i * hash_increment) % TABLE_SIZE] != -1) {
        i++;
        if (i == TABLE_SIZE) return -1;
    }
    table[(hash1 + i * hash_increment) % TABLE_SIZE] = key;
    return (hash1 + i * hash_increment) % TABLE_SIZE;
}

int doubleHashSearch(int table[], int key) {
    int hash1 = key % TABLE_SIZE;
    int hash_increment = hash2(key);
    int i = 0;
    while (table[(hash1 + i * hash_increment) % TABLE_SIZE] != key) {
        if (table[(hash1 + i * hash_increment) % TABLE_SIZE] == -1 || i == TABLE_SIZE) return -1;
        i++;
    }
    return (hash1 + i * hash_increment) % TABLE_SIZE;
}

// ------------------- MAIN -------------------
void printTable(int table[]) {
    for (int i = 0; i < TABLE_SIZE; i++) {
        if (table[i] != -1)
            printf("%d ", table[i]);
        else
            printf("_ ");
    }
    printf("\n");
}

int main() {
    int linearTable[TABLE_SIZE];
    int quadTable[TABLE_SIZE];
    int doubleTable[TABLE_SIZE];
    for (int i = 0; i < TABLE_SIZE; i++) {
        linearTable[i] = quadTable[i] = doubleTable[i] = -1;
    }

    int keys[] = {23, 43, 13, 27};
    int n = sizeof(keys)/sizeof(keys[0]);

    printf("Linear Probing:\n");
    for (int i = 0; i < n; i++) linearHashInsert(linearTable, keys[i]);
    printTable(linearTable);

    printf("Quadratic Probing:\n");
    for (int i = 0; i < n; i++) quadraticHashInsert(quadTable, keys[i]);
    printTable(quadTable);

    printf("Double Hashing:\n");
    for (int i = 0; i < n; i++) doubleHashInsert(doubleTable, keys[i]);
    printTable(doubleTable);

    return 0;
}

/*
Time Complexity: 
    Insertion/Search: Average O(1), Worst O(n) for all probing methods
Space Complexity: O(TABLE_SIZE) for all methods
*/
